---
title: 'Beyond the Bookshelf: Family Influences on Early Language Production'
author: "Cecilia Nguyen, Kristen Gilyard, Elika Bergelson"
output: 
  html_document:
    toc_depth: 2
    number_sections: true
    theme: journal
    highlight: tango
csl: apa.csl
---

# Introduction

Early childhood is a critical period for language acquisition, shaped by a complex interplay of biological maturation and environmental input. While caregiver interaction is a well-established influence on early language outcomes, the broader family context, particularly the presence of siblings and multilingual exposure, plays a significant but complex role [\@<https://doi.org/10.1016/j.dr.2005.11.002>], [\@<https://psycnet.apa.org/doi/10.2307/1130985>].

The resource dilution model (RDM) posits that parental attention and cognitive resources are finite and become increasingly divided as family size grows, potentially limiting the amount and quality of linguistic input each child receives [\@<http://dx.doi.org/10.3389/fpsyg.2015.01874>]. In bilingual households, where language exposure may already be limited or uneven across languages, siblings may act as both sources of input and competitors for these constrained linguistic resources. Supporting this, studies have shown that children from families with multiple siblings, particularly three or more, tend to have lower second language (L2) skills, especially when access to early education is limited [[\@]{.underline}<https://doi.org/10.3389/fpsyg.2015.00705>]. However, the effect of siblings is not unidirectional. Older siblings may act as linguistic models and provide rich communicative experiences that supplement parental input. Research suggests that the gender and age gap of siblings can also shape the quality of these interactions, with some studies indicating that older sisters contribute more positively to early language outcomes than older brothers [\@<https://doi.org/10.1177/0956797619861436>].

Still, the findings are mixed. While some studies report a positive influence of older siblings—particularly sisters—others find minimal or even negative effects once other variables, such as parental interaction quality, are accounted for [\@<https://doi.org/10.1111/infa.12578>]. Moreover, relatively little is known about how specific sibling identities and multilingual environments intersect to shape early vocabulary development. Few studies have incorporated detailed measures of parent-child reading behaviors, despite evidence that such interactions are closely linked to vocabulary growth and later academic achievement.

# Methodology

The present study investigates whether sibling identity, household language environment, and parent-child reading engagement are associated with toddlers’ language production. Parents of 74 toddlers completed surveys about their household composition, reading behaviors, and language practices. Language production was assessed using the MacArthur-Bates Communicative Development Inventory (MB-CDI), with the Words and Sentences (WS) form used for children over 19 months and the Words and Gestures (WG) form used for children under 19 months. From these surveys, we calculated standardized production scores and derived parent and child reading behavior scores based on reported practices such as elaboration, object labeling, and child pointing. The sample included 53 children with siblings and 21 without, and 18 households reported speaking a non-English language at home. This data provides an opportunity to explore how family-level factors interact with language development during a period of rapid linguistic growth.

```{r install, echo=FALSE, message=FALSE, warning=FALSE}
download.file("https://www.zotero.org/styles/apa", destfile = "apa.csl")
#install.packages("readxl")
#install.packages("readr")
#install.packages("dplyr")
#install.packages("tidyr")
#install.packages("ggplot2")
#install.packages("stringr")
#install.packages("dplyr")
#install.packages("brms")
#install.packages("knitr")
#install.packages("kableExtra")
#install.packages("ggcorrplot")
#install.packages("forcats")
#install.packages("officer")
#install.packages("flextable")
#install.packages("RVAideMemoire")
#install.packages("gt")
#install.packages("MASS")
#install.packages("broom")
#install.packages("sjPlot")
#install.packages("lme4")
#install.packages("plotly)
#install.packages("patchwork")
#install.packages("ggpubr")

library(ggpubr)
library(patchwork)  
library(plotly)
library(lme4)
library(sjPlot)
library(MASS)
library(dplyr)
library(broom)
library(RVAideMemoire)
library(brms)
library(knitr)
library(kableExtra)
library(readxl)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(dplyr)
library(ggcorrplot)
library(forcats)
library(officer)
library(flextable)
library(gt)


combined <- readRDS("combined.rds")

setwd("/Volumes/Fas-Phyc-PEB-Lab/experimental_projects/PBS/PBS_Full_Study/CN_Working_Folder/R/Survey")

sibship_factors <- readxl::read_xlsx("Sibship_Factors.xlsx")

sibship_factors <- sibship_factors %>%
  filter(Sib_Identity != "n/a", Sib_Identity != "", !is.na(Sib_Identity))

#Set Theme with same sizes for all plots
custom_theme <- theme_minimal(base_size = 10, base_family = "Times") +
  theme(
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 14),
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
  )
```

```{r calculating parent and child scores, echo=FALSE, message=FALSE,warning=FALSE}
combined$Q64_1 <- as.numeric(combined$Q64_1)
combined$Q38_1 <- as.numeric(combined$Q38_1)
combined$Q39_1 <- as.numeric(combined$Q39_1)
combined$Q54_1 <- as.numeric(combined$Q54_1)
combined$Q65_1 <- as.numeric(combined$Q65_1)

combined$parent_score <- rowSums(combined[, c("Q64_1", "Q54_1", "Q65_1", "Q38_1", "Q39_1")], na.rm = TRUE)

combined <- combined %>%
  filter(parent_score > 0)


combined$Q55_1 <- as.numeric(combined$Q55_1)
combined$Q56_1 <- as.numeric(combined$Q56_1)
combined$Q57_1 <- as.numeric(combined$Q57_1)
combined$Q43_1 <- as.numeric(combined$Q43_1)
combined$Q44_1 <- as.numeric(combined$Q44_1)

combined$child_score <- rowSums(combined[, c("Q55_1", "Q56_1", "Q57_1", "Q43_1", "Q44_1")], na.rm = TRUE)

combined <- combined %>%
  filter(child_score > 0)


sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)
combined$subject_id <- as.character(combined$subject_id)

combined <- combined %>%
  mutate(
    `Words Understood` = as.numeric(`Words Understood`),
    `Words Produced` = as.numeric(`Words Produced`)
  )


```

# **Visualizations & Descriptive Stats**

## Descriptive Tables

```{r making a dataframe with sibship factors and child/parent scores with words produced, echo=FALSE, message=FALSE,warning=FALSE}

combined$subject_id <- as.character(combined$subject_id)
sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)

id_scores <- combined %>%
  select(subject_id, age, child_score, parent_score, `Words Understood`,`Words Produced`, `Total Produced`) %>%
  distinct(subject_id, .keep_all = TRUE)
 
sibship_factors <- sibship_factors %>%
  left_join(
    combined %>%
      select(subject_id, parent_score, child_score, `Words Produced`, `Words Understood`, `Total Produced`),
    by = c("Subject_ID" = "subject_id"))

sib_scores <- combined %>%
  filter(combined[[ which(grepl("Are there any other children", colnames(combined))) ]] == "Yes") %>%
  select(subject_id, age, child_score, parent_score, `Words Understood`, `Words Produced`, `Total Produced`)
```

```{r table of descriptive stats, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

id_scores <- id_scores %>%
  rename_with(~ gsub(" ", "_", .x)) %>%
  mutate(across(c(age, child_score, parent_score, Words_Understood, Words_Produced, Total_Produced), as.numeric))


id_scores %>%
  summarise(
    across(
      c(age, child_score, parent_score, Words_Understood, Words_Produced, Total_Produced),
           list(
             Mean = ~ mean(.x, na.rm = TRUE),
             SD = ~ sd(.x, na.rm = TRUE),
             N = ~ sum(!is.na(.x))
           ),
       .names = "{.col}__{.fn}")
  ) %>%
  pivot_longer(
    everything(),
    names_to = c("Variable", "Statistic"),
    names_sep = "__"
  ) %>%
  pivot_wider(
    names_from = Statistic,
    values_from = value
  ) %>%
  mutate(Variable = recode(Variable,
                           age = "Child Age (m)",
                           child_score = "Child Score",
                           parent_score = "Parent Score",
                           Words_Understood = "Words Understood",
                           Words_Produced = "Words Produced",
                           Total_Produced = "Total Produced")) %>%
  select(Variable, Mean, SD, N) %>%
  kable(
    digits = 3,
    align = "c"
  ) %>%
    kable_styling(full_width = FALSE, 
                position = "center", 
                bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  row_spec(0, bold = TRUE, color = "white", background = "palevioletred2") %>% 
  column_spec(1, bold = TRUE)

```

While most variables have around 70 participants, `Words Produced` and `Total Produced` have smaller N due to half the participants being WG and the other half being WS. This can lower power and increase uncertainty.

`Child Score` and `Parent Score` means were fairly close to each other, however the SDs suggest variability, indicating that some children and parents score much higher and some much lower.

`Words Produced` and `Total Produced` had a very large difference in mean and SDs, which suggest that some children were producing very few words while others were producing very many. TThis is to be expected because `Words Produced` data derived from WG, which were given to children \<19 months of age, while `Total Produced` came from WS, given to children \>19 months.

```{r descriptive stats of children with siblings, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
sib_scores <- sib_scores %>%
  rename_with(~ gsub(" ", "_", .x)) %>%
  mutate(across(c(age, child_score, parent_score, Words_Understood, Words_Produced, Total_Produced), as.numeric))


sib_scores %>%
  summarise(
    across(
      c(age, child_score, parent_score, Words_Understood, Words_Produced, Total_Produced),
           list(
             Mean = ~ mean(.x, na.rm = TRUE),
             SD = ~ sd(.x, na.rm = TRUE),
             N = ~ sum(!is.na(.x))
           ),
       .names = "{.col}__{.fn}")
  ) %>%
  pivot_longer(
    everything(),
    names_to = c("Variable", "Statistic"),
    names_sep = "__"
  ) %>%
  pivot_wider(
    names_from = Statistic,
    values_from = value
  ) %>%
  mutate(Variable = recode(Variable,
                           age = "Child Age (m)",
                           child_score = "Child Score",
                           parent_score = "Parent Score",
                           Words_Understood = "Words Understood",
                           Words_Produced = "Words Produced",
                           Total_Produced = "Total Produced")) %>%
  select(Variable, Mean, SD, N) %>%
  kable(
    digits = 3,
    align = "c"
  ) %>%
    kable_styling(full_width = FALSE, 
                position = "center", 
                bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  row_spec(0, bold = TRUE, color = "white", background = "palevioletred2") %>% 
  column_spec(1, bold = TRUE)
```

## MBCDI Output

`Words Understood` and `Words Produced` are taken from the WG form while `Total Produced` is taken from the WS form.

```{r words-understood graph, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=6, fig.height=2.5}
combined$`Words Understood` <- as.numeric(as.character(combined$`Words Understood`))
n_wu <- combined %>%
  filter(!subject_id %in% c(35, 25, 14)) %>%
  summarise(N = sum(!is.na(`Words Understood`))) %>%
  pull(N)
total_N <- nrow(combined)

ggplot(combined %>% filter(!subject_id %in% c(35, 25, 14)),
       aes(x = `Words Understood`)) + 
  geom_histogram(binwidth = 30, fill = "pink2", color = "white") +
  scale_y_continuous(limits = c(0, 8)) +
  labs(
    x = "Word Comprehension (WG)",
    y = "Frequency"
  ) + 
  annotate("text", x = Inf, y = Inf, label = paste0("N = ", n_wu),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
theme_minimal(base_size = 10, base_family = "Times") + custom_theme

```

```{r words-produced graph, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=6, fig.height=2.5}
combined$`Words Produced` <- as.numeric(as.character(combined$`Words Produced`))
n_wp <- sum(!is.na(combined$`Words Produced`))

ggplot(combined %>% filter(!subject_id %in% c(35, 25, 14)),
       aes(x = `Words Produced`)) + 
  geom_histogram(binwidth = 5, fill = "pink2", color = "white") +
  scale_y_continuous(limits = c(0, 7)) +
  labs(
    x = "Word Production (WG)",
    y = "Frequency"
  ) + 
    annotate("text", x = Inf, y = Inf, label = paste0("N = ", n_wp),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
  theme_minimal(base_size = 12, base_family = "Times") + custom_theme
```

```{r total-produced graph WS, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=6, fig.height=2.5}
combined$`Total Produced` <- as.numeric(combined$`Total Produced`)
n_tp <- sum(!is.na(combined$`Total Produced`))

ggplot(combined, aes(x = `Total Produced`)) + 
  geom_histogram(binwidth = 25, fill = "pink2", color = "white") +
  scale_y_continuous(limits = c(0, 5)) +
  labs(
    x = "Total Production (WS)",
    y = "Frequency"
  ) + 
    annotate("text", x = Inf, y = Inf, label = paste0("N = ", n_tp),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme

```

## Age Breakdown

```{r breakdown of age, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=6, fig.height=2.5}
combined$age <- as.numeric(combined$age)

ggplot(combined, aes(x = age)) + 
  geom_histogram(binwidth = 1, fill = "lightblue2", color = "white") +
  scale_y_continuous(limits = c(0, 11)) +
  labs(
    x = "Age (m)",
    y = "Frequency"
  ) + 
    annotate("text", x = Inf, y = Inf, label = paste0("N = ", total_N),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme

```

```{r scatter plot of words understood by age, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=6, fig.height=2.5}
combined$age <- as.numeric(combined$age)
combined$`Words Produced` <- as.numeric(combined$`Words Understood`)

ggplot(
  data = combined %>% filter(!subject_id %in% c(35, 25, 14)),
  aes(x = age, y = `Words Understood`)
) +
  scale_x_continuous(limits = c(13, 18)) +
  scale_y_continuous(limits = c(0, 200)) +
  geom_jitter(width = 0.2, height = 10, alpha = 0.6, size = 2) +
  geom_smooth(method = "loess", se = TRUE, color = "steelblue2", size = 1.2) +
  labs(
    x = "Age (months)",
    y = "Words Understood (WG)"
  ) +
      annotate("text", x = Inf, y = Inf, label = paste0("N = ", n_wu),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme
```

```{r scatter plot of words produced by age, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=6, fig.height=2.5}
combined$age <- as.numeric(combined$age)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)

ggplot(
  data = combined %>% filter(!subject_id %in% c(35, 25, 14)),
  aes(x = age, y = `Words Produced`)
) +
  scale_x_continuous(limits = c(13, 18)) +
  scale_y_continuous(limits = c(0, 200)) +
  geom_jitter(width = 0.2, height = 10, alpha = 0.6, size = 2) +
  geom_smooth(method = "loess", se = TRUE, color = "steelblue2", size = 1.2) +
  labs(
    x = "Age (months)",
    y = "Words Produced (WG)"
  ) +
      annotate("text", x = Inf, y = Inf, label = paste0("N = ", n_wp),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme
```

```{r scatter plot of total produced by age, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=6, fig.height=2.5}

ggplot(
  combined %>% filter(!is.na(age)),
  aes(x = age, y = `Total Produced`)) +
    scale_x_continuous(limits = c(19, 27)) +
  scale_y_continuous(limits = c(0, 600)) +
    geom_jitter(width = 0.2, height = 0, alpha = 0.6, size = 2) +
  geom_smooth(method = "loess", se = TRUE, color = "steelblue2", size = 1.2) +
  labs(
  x = "Age (months)",
  y = "Total Produced (WG)"
) +
  annotate("text", x = Inf, y = Inf, label = paste0("N = ", n_tp),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme

```

```{r model-prod-child-age, message=FALSE, warning=FALSE}


model_prod_child_age <- lm(`Words Produced` ~ child_score + age, data = combined)

combined$predicted_wp <- predict(model_prod_child_age, newdata = combined)


ggplot(combined[!is.na(combined$predicted_wp), ], aes(x = predicted_wp, y = `Words Produced`)) +
  geom_point(color = "steelblue", size = 2) +
  geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "darkred") +
  labs(
    title = "Predicted vs. Actual Word Production",
    x = "Predicted Words Produced",
    y = "Actual Words Produced"
  ) +
  theme_minimal(base_family = "Times") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5))

```

## Children and Parent Scores

Specific questions were used to calculate respective parent and child scores. Each score takes into account 5 questions. The child score is a score that describes children behaviors during reading session such as pointing at things on the page. The parent score is what parents do during the session, such as extending beyond the text of the book. Below is a chart depicting what items from the survey is used to calculate the parent and child score respectively. Both scores are out of 40.

```{r chart with parent/child score q, echo=FALSE, message=FALSE, warning=FALSE}
#This creating a chart for the Parent Score and Child Score Itmes on the Survey
library(officer)
library(flextable)
#First we list each of the items for parent and child score
score_items <- data.frame(
  `Parent Score Items` = c("Extending beyond the text: connection to things in the book", "Extending beyond the text: connection to outside of the book", "Labelling/naming objects", "Asking questions", "Pausing to wait for child’s response"),
  `Child Score Items` = c("Child repeats words from book", "Child touches objects on the pages of the book", "Child looks at items on the page during book-reading", "Child points to objects on the page during book-reading", "Child vocalizes or makes sounds during book-reading" ),
  check.names = FALSE)
#Then add a note at the end
footnote_text <- as_paragraph("Note: All items were noted in relation to ", as_chunk("during book-reading sessions", props = officer::fp_text(bold = TRUE)), " and were rated on a 7-point Likert scale ranging from 1 (not often) to 7 (very often).")
# Now creat the table
flextable(score_items) %>% set_caption("Survey Items Used to Compute Composite Parent and Child Scores") %>% 
  theme_booktabs() %>%
  autofit() %>%
  align(align = "left", part = "all") %>%
  vline(j = 1, border = officer::fp_border(color = "black", width = 1)) %>%
  add_footer_lines(values = footnote_text) %>%
  font(fontname = "Times New Roman", part = "all")

```

### Parent Score

```{r parent score plot, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=6, fig.height=3}
ggplot(combined, aes(x = parent_score)) +
  geom_histogram(binwidth = 2, fill = "plum3", color = "white", alpha = 0.8) +
  labs(
    x = "Parent Score",
    y = "Frequency"
  ) +
annotate("text", x = Inf, y = Inf, label = paste0("N = ", total_N),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
  annotate("text", x = Inf, y = Inf, label = paste0("N = ", total_N),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
  theme_minimal(base_size = 12, base_family = "Times") + custom_theme

```

### Child Score

```{r child score graphs, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=6, fig.height=3}
ggplot(combined, aes(x = child_score)) + 
  geom_histogram(binwidth = 2, fill = "plum3", color = "white") +
  scale_y_continuous(limits = c(0, 12)) +
  labs(
    x = "Child Score",
    y = "Frequency"
  ) + 
    annotate("text", x = Inf, y = Inf, label = paste0("N = ", total_N),
           hjust = 1.1, vjust = 1.5, size = 3.5, family = "Times") +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme
```

```{r score-wu-densityplots, message=FALSE, warning=FALSE, fig.width=10, fig.height=4}


combined_long <- combined %>%
  select(parent_score, child_score, `Words Understood`) %>%
  rename(
    Parent = parent_score,
    Child = child_score,
    WordProd = `Words Understood`
  ) %>%
  pivot_longer(cols = c(Parent, Child), names_to = "Score_Type", values_to = "Score")

ggplot(combined_long, aes(x = Score, y = WordProd, color = Score_Type, fill = Score_Type)) +
  geom_point(alpha = 0.6, size = 2) +  # ⬅️ Adds the dots
  geom_smooth(method = "loess", se = FALSE, size = 1.2) +
  scale_fill_manual(values = c("skyblue", "orange")) +
  scale_color_manual(values = c("#6e772d", "#dd702d")) +
  labs(
    x = "Score Value",
    y = "Words Understood (WG)",
    fill = "Score Type",
    color = "Type of Score"
  ) +
  theme_minimal(base_family = "Times") +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5)
  ) +
  guides(fill = "none") +
  custom_theme


```

```{r score-wp-densityplots, message=FALSE, warning=FALSE, fig.width=10, fig.height=4}


combined_long <- combined %>%
  select(parent_score, child_score, `Words Produced`) %>%
  rename(
    Parent = parent_score,
    Child = child_score,
    WordProd = `Words Produced`
  ) %>%
  pivot_longer(cols = c(Parent, Child), names_to = "Score_Type", values_to = "Score")

ggplot(combined_long, aes(x = Score, fill = Score_Type)) +
  geom_density(alpha = 0.4) +
  geom_smooth(aes(y = WordProd, color = Score_Type), method = "loess", se = FALSE, size = 1.2) +
  scale_fill_manual(values = c("skyblue", "orange")) +
  scale_color_manual(values = c("#6e772d", "#dd702d")) +
  labs(
    x = "Score Value",
    y = "Words Produced (WG)",
    fill = "Score Type",
    color = "Type of Score"
  ) +
  theme_minimal(base_family = "Times") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5)) + guides(fill = "none") + custom_theme

```

```{r score-tp-densityplots, message=FALSE, warning=FALSE, fig.width=10, fig.height=4}

combined_long <- combined %>%
  select(parent_score, child_score, `Total Produced`) %>%
  rename(
    Parent = parent_score,
    Child = child_score,
    WordProd = `Total Produced`
  ) %>%
  pivot_longer(cols = c(Parent, Child), names_to = "Score_Type", values_to = "Score")

ggplot(combined_long, aes(x = Score, fill = Score_Type)) +
  geom_density(alpha = 0.4) +
  geom_smooth(aes(y = WordProd, color = Score_Type), method = "loess", se = FALSE, size = 1.2) +
  scale_fill_manual(values = c("skyblue", "orange")) +
  scale_color_manual(values = c("#6e772d", "#dd702d")) +
  labs(
    x = "Score Value",
    y = "Total Produced (WS)",
    fill = "Score Type",
    color = "Type of Score"
  ) +
  theme_minimal(base_family = "Times") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5)) + guides(fill = "none") + custom_theme

```
## Household Details

### Sibling Count and Identity

After looking at the parent and child scores, the specific household details, specifically about sibling count and identity was graphed. `Sibling Identity` refers to the sibling's relation to the target child.

```{r sibling count graph, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

sib_yesno <- table(
  factor(
    combined$`Are there any other children who live in your home?`,
    levels = c("Yes", "No")
  )
)

sib_yesno <- as.data.frame(sib_yesno)
colnames(sib_yesno) <- c("Answer", "Count")

householdplot <- ggplot(sib_yesno, aes(x = Answer, y = Count, fill = Answer)) + 
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = Count), hjust = -0.3, family = "Times", size = 4) +
  coord_flip() +
  expand_limits(y = max(sib_yesno$Count) * 1.1) +
  scale_fill_manual(values = c("Yes" = "#f2af36", "No" = "#6e772d")) + 
  theme_minimal(base_size = 8, base_family = "Times") +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14)
  ) +
  custom_theme

householdplot
```

```{r graph of sibling identity, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3.5}
setwd("/Volumes/Fas-Phyc-PEB-Lab/experimental_projects/PBS/PBS_Full_Study/CN_Working_Folder/R/Survey")
sibship_factors <- readxl::read_xlsx("Sibship_Factors.xlsx")

sibship_factors <- sibship_factors %>%
  filter(Sib_Identity != "n/a", Sib_Identity != "", !is.na(Sib_Identity))

ggplot(sibship_factors, aes(x = Sib_Identity))+
  geom_bar(fill = "lightblue2") +
  geom_text(stat = "count", aes(label = ..count..),vjust = -0.3) +
  scale_y_continuous(limits = c(0, 40)) +
  labs(
    x = "Sibling Identity",
    y = "Count"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + 
      theme(plot.title = element_text(hjust = 0.5, size = 12) ) + custom_theme

```



```{r lang df with scores, fig.width = 6, fig.height = 8, echo=FALSE, message=FALSE,warning=FALSE}

lang_df <- combined %>%
  select(subject_id, age, child_score, parent_score, `Words Understood`, `Words Produced`, `Total Produced`, `Are there any other languages spoken in your home?`, `Are there any other children who live in your home?`) %>%
  distinct(subject_id, .keep_all = TRUE) %>%
  rename(`Other Language?` = `Are there any other languages spoken in your home?`) %>%
    mutate(
    lang_binary = case_when(
      tolower(`Other Language?`) %in% c("no", "none", "english") ~ "No",
      TRUE ~ "Yes")) %>%
  rename(`Have Sibs?` = `Are there any other children who live in your home?`) %>%
    mutate(
    sib_binary = case_when(
      tolower(`Have Sibs?`) %in% c("no", "none", "english") ~ "No",
      TRUE ~ "Yes"))

  lang_df <- lang_df %>%
  mutate(Produced = coalesce(`Words Produced`, `Total Produced`))
```

```{r sibling-identity-child-score, message=FALSE, warning=FALSE, fig.width=6, fig.height=4}

sibship_factors <- sibship_factors %>% mutate(Subject_ID = as.character(Subject_ID))
combined <- combined %>% mutate(subject_id = as.character(subject_id))


sibship_factors <- sibship_factors %>%
  left_join(
    combined %>%
      select(subject_id, parent_score, child_score, `Words Produced`, `Words Understood`, `Total Produced`),
    by = c("Subject_ID" = "subject_id"))

sibship_factors$Sib_Identity <- factor(sibship_factors$Sib_Identity, levels = c("Older Sister", "Older Brother"))

ggplot(sibship_factors %>% filter(!is.na(Sib_Identity)),
       aes(x = Sib_Identity, y = child_score, fill = Sib_Identity)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  scale_fill_manual(name = "Sibling?", values = c("turquoise", "orchid")) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") +
  scale_y_continuous(limits = c(0, 40)) +
  stat_summary(fun.data = "mean_cl_boot", geom = "pointrange", colour = "black") +
  labs(
    x = "Have Sib?",
    y = "Child Score"
  ) +
  theme_minimal(base_size = 15, base_family = "Times")


```

```{r box-plot of sib CS, echo=FALSE, fig.align='center', fig.height=3, fig.width=5, message=FALSE, warning=FALSE}
sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)
combined$subject_id <- as.character(combined$subject_id)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)


ggplot(lang_df, aes(x = sib_binary, y = child_score)) +
  geom_boxplot(outlier.shape = NA, fill = "plum3", alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
    scale_y_continuous(limits = c(0,40)) +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    x = "Have Sib?",
    y = "Child Score"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme

```


```{r box-plot of words produced by household size, echo=FALSE, fig.align='center', fig.height=3, fig.width=5, message=FALSE, warning=FALSE}
sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)
combined$subject_id <- as.character(combined$subject_id)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)

ggplot(lang_df %>% filter(!subject_id %in% c(35, 25, 14)),
       aes(x = `Have Sibs?`, y = `Words Produced`,colour =`Have Sibs?`, fill=`Have Sibs?`)) + scale_colour_manual(values = c(Yes = "darkolivegreen3", No = "tan3")) +  scale_fill_manual(values = c(Yes = "darkolivegreen3", No = "tan3")) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
    scale_y_continuous(limits = c(0,450)) +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    x = "Have Sibs?",
    y = "Words Produced (WG)"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme
```

```{r child-score-by-sibling, message=FALSE, warning=FALSE, fig.width=5, fig.height=4}

combined$Sibling <- factor(combined$`Are there any other children who live in your home?`, levels = c("No", "Yes"))

child_sib_test <- wilcox.test(child_score ~ Sibling, data = combined)

ggplot(lang_df, aes(x = sib_binary, y = child_score, fill = sib_binary)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  scale_fill_manual(  name = "Sibling?", values = c("#b2bf6d", "#dd702d")) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") +
  scale_y_continuous(limits = c(0, 40)) +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
  ) +
  labs(
    x = "Have Sib?",
    y = "Child Score"
  ) +
  theme_minimal(base_size = 15, base_family = "Times") + 
  stat_summary(fun.data = "mean_cl_boot", geom = "pointrange",
               colour = "black")
```


```{r child-production-by-sibling, message=FALSE, warning=FALSE, fig.width=5, fig.height=4}

combined$Sibling <- factor(combined$`Are there any other children who live in your home?`, levels = c("No", "Yes"))
combined$Sibling <- factor(combined$Sibling)
combined <- droplevels(combined)

child_sib_test <- wilcox.test(`Words Produced` ~ Sibling, data = combined)

ggplot(lang_df, aes(x = sib_binary, y = `Produced`, fill = sib_binary)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  scale_fill_manual(  name = "Sibling?", values = c("#b2bf6d", "#dd702d")) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") +
  scale_y_continuous(limits = c(0, 500)) +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x))) * 1.25
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
  ) +
  labs(
    x = "Have Sib?",
    y = "Words Produced (WG)"
  ) +
  theme_minimal(base_size = 15, base_family = "Times") + 
  stat_summary(fun.data = "mean_cl_boot", geom = "pointrange",
               colour = "black")


```

### Multilingual Household

Multilingual households were also looked at. Out of 65 families, only 18 have another language, that is not English, spoken at home. The responses were also categorized by language group. `Multilingual` refers to households that speak more than one language as to not double count subjects.

```{r other languages plot, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3.5}
lang_yesno <- table(combined$`Are there any other languages spoken in your home?`) %>%
  as.data.frame() %>%
  rename(
    Language = Var1,
    Count = Freq
  ) %>%
  mutate(
    lang_binary = case_when(
      tolower(Language) %in% c("no", "none", "english","no /youtube french or spanish vidoes") ~ "No",
      TRUE ~ "Yes"
    )
  ) %>%
  group_by(lang_binary) %>%
  summarise(Count = sum(Count))

ggplot(lang_yesno, aes(x = lang_binary, y = Count, fill = lang_binary)) +
   geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = Count), vjust = -0.3) +
  labs(
    x = "Multilingual?",
    y = "Count"
  ) +
  scale_fill_manual(values = c("Yes" = "lightcoral", "No" = "royalblue1")) +
  scale_y_continuous(limits = c(0, 55)) +
  theme_minimal(base_size = 14, base_family = "Times") + custom_theme +   theme(legend.position = "none")
```

```{r child-score-by-lang, message=FALSE, warning=FALSE, fig.width=6, fig.height=4}

combined$Sibling <- factor(combined$`Are there any other children who live in your home?`, levels = c("No", "Yes"))


ggplot(lang_df, aes(x = lang_binary, y = child_score, fill = lang_binary)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  scale_fill_manual(  name = "Multilingual?", values = c("royalblue1", "lightcoral")) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") +
  scale_y_continuous(limits = c(0, 40)) +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
  ) +
  labs(
    x = "Multilingual?",
    y = "Child Score"
  ) +
  theme_minimal(base_size = 15, base_family = "Times") + 
  stat_summary(fun.data = "mean_cl_boot", geom = "pointrange",
               colour = "black")
```

```{r child-prod-by-lang, message=FALSE, warning=FALSE, fig.width=6, fig.height=4}

ggplot(lang_df, aes(x = lang_binary, y = `Produced`, fill = lang_binary)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  scale_fill_manual(  name = "Multilingual?", values = c("royalblue1", "lightcoral")) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") +
  scale_y_continuous(limits = c(0, 400)) +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
  ) +
  labs(
    x = "Multilingual?",
    y = "Word Production"
  ) +
  theme_minimal(base_size = 15, base_family = "Times") + 
  stat_summary(fun.data = "mean_cl_boot", geom = "pointrange",
               colour = "black")
```

```{r graph of other lang spoken, fig.width = 5, fig.height = 5, echo=FALSE, message=FALSE,warning=FALSE}
lang_other <- combined %>%
  select(subject_id, age, child_score, parent_score, `Words Produced`, `Total Produced`, `Are there any other languages spoken in your home?`) %>%
  distinct(subject_id, .keep_all = TRUE) %>%
  rename(`Other Language?` = `Are there any other languages spoken in your home?`) %>%
  mutate(`Other Language?` = tolower(`Other Language?`)) %>%
  filter(!`Other Language?` %in% c("no", "none", "english", "no /youtube french or spanish vidoes"))

lang_other$`Other Language?` <- tolower(lang_other$`Other Language?`)

lang_other <- lang_other %>%
  filter(!is.na(`Other Language?`), !is.na(`Other Language?`))

lang_other <- lang_other %>%
  mutate(Produced = coalesce(`Words Produced`, `Total Produced`))


lang_other <- lang_other %>%
  filter(!`Other Language?` %in% c("no", "none", "english", "no /youtube french or spanish vidoes"))
```

```{r table of multilingual households lang frequencies, fig.width = 5, fig.height = 5, echo=FALSE, message=FALSE,warning=FALSE}
lang_table <- lang_other %>%
  filter(!is.na(`Other Language?`)) %>%
  mutate(
    `Other Language?` = str_to_lower(`Other Language?`),
    Language = case_when(
      str_detect(`Other Language?`, ",") ~ "Multilingual",
      str_detect(`Other Language?`, "spanish") ~ "Spanish",
      str_detect(`Other Language?`, "mandarin") ~ "Mandarin Chinese",
      str_detect(`Other Language?`, "cantonese") ~ "Cantonese",
      str_detect(`Other Language?`, "russian") ~ "Russian",
      str_detect(`Other Language?`, "arabic") ~ "Arabic",
      str_detect(`Other Language?`, "farsi") ~ "Farsi",
      str_detect(`Other Language?`, "hebrew") ~ "Hebrew",
      str_detect(`Other Language?`, "korean") ~ "Korean",
      str_detect(`Other Language?`, "urdu") ~ "Urdu",
      str_detect(`Other Language?`, "haitian creole") ~ "Haitian Creole",
      str_detect(`Other Language?`, "taiwanese") ~ "Taiwanese",
      str_detect(`Other Language?`, "malyalam") ~ "Malayalam",
      str_detect(`Other Language?`, "vietnamese") ~ "Vietnamese",
      TRUE ~ str_to_title(`Other Language?`)
    )
  ) %>%
  count(Language, sort = TRUE)

colnames(lang_table) <- c("Language", "N")

kable(lang_table)
```

# Comprehension & Production, Correlation, and Parent/Child Score by Sibling Identity

Due to the low observations in the younger siblings identity, it was taken out of visualizations and analysis. There were also twins in the data, however, because twins are likely to experience highly similar environments and interactions, their inclusion could violate assumptions of data independence, their data was excluded. This was to ensure each data point reflected a unique household dynamic, twin data were excluded from comparative analyses.

```{r box-plot of words produced by sib identity, echo=FALSE, fig.align='center', fig.height=3, fig.width=5, message=FALSE, warning=FALSE}
sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)
combined$subject_id <- as.character(combined$subject_id)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)

ggplot(sibship_factors %>%
         filter(!Sib_Identity %in% c("Twin", "Younger Brother", "Younger Sister")),
  aes(x = Sib_Identity, y = `Words Produced`)) +
  geom_boxplot(outlier.shape = NA, fill = "plum3", alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
    scale_y_continuous(limits = c(0,450)) +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    x = "Sibling Identity",
    y = "Words Produced (WG)"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme
```

```{r box-plot of words understood by sib identity, echo=FALSE, fig.align='center', fig.height=3, fig.width=5, message=FALSE, warning=FALSE}
sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)
combined$subject_id <- as.character(combined$subject_id)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)

ggplot(sibship_factors %>%
         filter(!Sib_Identity %in% c("Twin", "Younger Brother", "Younger Sister")),
  aes(x = Sib_Identity, y = `Words Understood`)) +
  geom_boxplot(outlier.shape = NA, fill = "plum3", alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    x = "Sibling Identity",
    y = "Words Understood (WG)"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme

```

```{r box-plot of total produced by sib identity, echo=FALSE, fig.align='center', fig.height=3, fig.width=5, message=FALSE, warning=FALSE}
sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)
combined$subject_id <- as.character(combined$subject_id)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)
combined$`Total Produced` <- as.numeric(combined$`Total Produced`)
sibship_factors$`Total Produced` <- as.numeric(sibship_factors$`Total Produced`)

ggplot(sibship_factors %>%
         filter(!Sib_Identity %in% c("Twin", "Younger Brother", "Younger Sister")),
  aes(x = Sib_Identity, y = `Total Produced`)) +
  geom_boxplot(outlier.shape = NA, fill = "plum3", alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    x = "Sibling Identity",
    y = "Total Produced (WS)"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme

```


```{r correlation between mbcdi and parent/child score, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

combined$`Total Produced` <- as.numeric(combined$`Total Produced`)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)

corr_plot <- cor(
  combined[, c("child_score", "parent_score", "Total Produced", "Words Produced", "Words Understood")],
  use = "pairwise.complete.obs"
)

colnames(corr_plot) <- c("Child", "Parent", "Total Produced", "Words Produced", "Words Understood")
rownames(corr_plot) <- c("Child", "Parent", "Total Produced", "Words\nProduced", "Words\nUnderstood")


ggcorrplot(
  corr_plot,
  method = "square",
  type = "upper",
  lab = TRUE,
  lab_size = 5,
  colors = c("lightcoral", "white", "lightgreen"),
  tl.cex = 20,
  tl.srt = 45
) +
  theme_minimal(base_family = "Times") +
  theme(
    text = element_text(face = "bold", family = "Times"),
    axis.text = element_text(face = "bold", family = "Times"),
    plot.title = element_text(face = "bold", family = "Times", hjust = 0.5)
  ) +
  labs(
    x = NULL,   
    y = NULL   
  ) + custom_theme
```

```{r corr test spearman | child score , echo=FALSE, message=FALSE,warning=FALSE}
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)
combined$child_score <- as.numeric(combined$child_score)
combined$parent_score <- as.numeric(combined$parent_score)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)
combined$`Total Produced` <- as.numeric(combined$`Total Produced`)


WP_CS <- cor.test(combined$`Words Produced`, combined$child_score, method = "spearman", exact = TRUE)
WU_CS <- cor.test(combined$`Words Understood`, combined$child_score, method = "spearman", exact = TRUE)
TP_CS <- cor.test(combined$`Total Produced`, combined$child_score, method = "spearman", exact = TRUE)
```

```{r corr test spearman | parent score, echo=FALSE, message=FALSE,warning=FALSE}
WP_PS <- cor.test(combined$`Words Produced`, combined$parent_score, method = "spearman", exact = TRUE)
WU_PS <- cor.test(combined$`Words Understood`, combined$parent_score, method = "spearman", exact = TRUE)
TP_PS <- cor.test(combined$`Total Produced`, combined$parent_score, method = "spearman", exact = TRUE)
```

```{r summary table of the spearman tests, echo=FALSE, message=FALSE,warning=FALSE}

summary_table <- data.frame(
  Predictor = rep(c("Words Produced", "Words Understood", "Total Produced"), 2),
  Outcome = rep(c("Child Score", "Parent Score"), each = 3),
  Rho = c(
    WP_CS$estimate, WU_CS$estimate, TP_CS$estimate,
    WP_PS$estimate, WU_PS$estimate, TP_PS$estimate
  ),
  p_value = c(
    WP_CS$p.value, WU_CS$p.value, TP_CS$p.value,
    WP_PS$p.value, WU_PS$p.value, TP_PS$p.value
  )
)

summary_table <- summary_table %>%
  mutate(p_display = case_when(
    p_value == 1.028851e-08 ~ formatC(p_value, format = "e", digits = 2),
    p_value < .001 ~ "< .001",
    TRUE ~ formatC(p_value, format = "f", digits = 3)
  ))


summary_table %>%
  select(Predictor, Outcome, Rho, p_display) %>%
  gt() %>%
  fmt_number(columns = vars(Rho), decimals = 3) %>%
  cols_label(
    Predictor = "Predictor",
    Outcome = "Outcome",
    Rho = "Spearman's ρ",
    p_display = "p-value"
  ) %>%
  opt_table_font(font = "Times New Roman") %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "white"),
      cell_fill(color = "palevioletred2")
    ),
    locations = cells_column_labels(everything())
  ) %>%
  tab_options(
    table.font.size = px(12),
    table.width = pct(90)
  )

```
Spearman correlation analyses revealed significant positive relationships between children’s language production and comprehension and their overall scores. Specifically, both the number of words produced and understood by children were strongly correlated with their Child Score (ρ = 0.654, p < .001), suggesting that children who produced or understood more words tended to score higher. A moderate positive correlation was also found between Total Produced and Child Score (ρ = 0.517, p = .003). Parent Scores showed moderate, significant correlations with children’s Words Produced and Words Understood (ρ = 0.504, p = .001 for both), indicating some alignment between children's language abilities and parent-reported scores. However, the correlation between Total Produced and Parent Score was weaker and not statistically significant (ρ = 0.265, p = .150), suggesting limited predictive value of this measure for parent outcomes.

# Comparing Sibling Identities
```{r wilcox WU and sib yes no, echo=FALSE, message=FALSE, warning=FALSE}

sib_yesno_WU <- wilcox.test(
  `Words Understood` ~ `Are there any other children who live in your home?`,
  data = combined,
  exact = TRUE
)


```

```{r wilcox WP and sib yes no, echo=FALSE, message=FALSE, warning=FALSE}

sib_yesno_WP <- wilcox.test(
  `Words Produced` ~ `Are there any other children who live in your home?`,
  data = combined,
  exact = TRUE
)


```

```{r wilcox TP and sib yes no, echo=FALSE, message=FALSE, warning=FALSE}

sib_yesno_TP <- wilcox.test(
  `Total Produced` ~ `Are there any other children who live in your home?`,
  data = combined,
  exact = FALSE
)


```

```{r spearman result table, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

sib_wilcox_results <- data.frame(
  Outcome = c("Words Understood", "Words Produced", "Total Produced"),
  `W Statistic` = c(
    round(sib_yesno_WU$statistic, 1),
    round(sib_yesno_WP$statistic, 1),
    round(sib_yesno_TP$statistic, 1)
  ),
  `p-value` = c(
    sib_yesno_WU$p.value,
    sib_yesno_WP$p.value,
    sib_yesno_TP$p.value
  )
)

sib_wilcox_results$p_raw <- NULL

kable(sib_wilcox_results, , digits = 3) %>%
  kable_styling(full_width = FALSE, font_size = 18) %>%
  column_spec(1:ncol(sib_wilcox_results), extra_css = "font-family: 'Times New Roman';") %>%
  row_spec(0, bold = TRUE)

```

To examine whether language outcomes differed based on sibling presence, Wilcoxon rank-sum tests were conducted comparing children with and without siblings across three outcome variables.

None of the comparisons reached statistical significance. These results suggest that the presence of siblings in the household was not significantly related to vocabulary comprehension or production. This analysis supports the need to consider more nuanced sibling factors, such as sibling identity (e.g., older vs. younger) or birth order, in understanding early language variation.

```{r anova WU, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

sib_clean <- sibship_factors %>%
  filter(Sib_Identity %in% c("Older Brother", "Older Sister"))

anovaWU <- aov(`Words Understood` ~ Sib_Identity, data = sib_clean)
anovaWU_sum <- summary(anovaWU)[[1]]
anovaWU_table <- as.data.frame(anovaWU_sum)
colnames(anovaWU_table) <- c("Df", "Sum Sq", "Mean Sq", "F value", "p-value")
rownames(anovaWU_table) <- NULL
anovaWU_table$Group <- c("Sibling Identity", "Residuals")
anovaWU_table <- anovaWU_table[, c("Group", "Df", "Sum Sq", "Mean Sq", "F value", "p-value")]

anovaWU_table <- anovaWU_table %>%
  mutate(across(where(is.numeric), ~ round(.x, 2)))

if ("p-value" %in% colnames(anovaWU_table)) {
  if (is.numeric(anovaWU_table$`p-value`)) {
    anovaWU_table$`p-value` <- round(anovaWU_table$`p-value`, 3)
  } else {
    anovaWU_table$`p-value` <- as.character(anovaWU_table$`p-value`)
  }
}
anovaWU_table$`F value`[is.na(anovaWU_table$`F value`)] <- ""
anovaWU_table$`p-value`[is.na(anovaWU_table$`p-value`)] <- ""

knitr::kable(anovaWU_table, caption = "ANOVA: Older Siblings and Language Production")

```

To further explore whether specific sibling identities are associated with differences in language production, a one-way ANOVA was conducted. Due to the low N values, the ANOVA only examined whether language production differed between toddlers with an older brother and those with an older sister. Results revealed no significant effect of sibling identity on words understood, F(1, 39) = 0.06, p = .80. This suggests that, within the subset of children with older siblings, whether the sibling was a brother or sister was not associated with differences in early language comprehension. However, these results should be interpreted with caution due to the relatively small sample size, which may limit statistical power and the ability to detect subtle effects.

# Analysis by Language
Curious to see if there were differences in language outcome if the household was multilingual.

```{r full yes no sib df with scores, fig.width = 6, fig.height = 8, echo=FALSE, message=FALSE,warning=FALSE}
sib_df <- combined %>%
  select(subject_id, age, child_score, parent_score, `Words Produced`, `Total Produced`, `Are there any other children who live in your home?`) %>%
  distinct(subject_id, .keep_all = TRUE) %>%
  rename(`Have Sib?` = `Are there any other children who live in your home?`) 

  sib_df <- sib_df %>%
  mutate(Produced = coalesce(`Words Produced`, `Total Produced`))
```

```{r box plot words understood, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

ggplot(lang_df %>% filter(!subject_id %in% c(35, 25, 14)),
  aes(x = lang_binary, y = `Words Understood`)) +
  geom_boxplot(outlier.shape = NA, fill = "steelblue2", alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
    stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    title = "Words Understood",
    x = "Multilingual Household",
    y = "Production"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme
```

```{r box plot words produced, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}


ggplot(lang_df %>% filter(!subject_id %in% c(35, 25, 14)),
  aes(x = lang_binary, y = `Words Produced`)) +
  geom_boxplot(outlier.shape = NA, fill = "steelblue2", alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
    stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    title = "Words Produced",
    x = "Multilingual Household",
    y = "Production"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme
```

```{r box plot total produced, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
lang_df$`Total Produced` <- as.numeric(lang_df$`Total Produced`)

ggplot(lang_df,
  aes(x = lang_binary, y = `Total Produced`)) +
  geom_boxplot(outlier.shape = NA, fill = "steelblue2", alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
    stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    title = "Total Produced",
    x = "Multilingual Household",
    y = "Production"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme
```

```{r wilcox WU lang yes no, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

lang_yesno_WU <- wilcox.test(
  `Words Understood` ~ lang_binary,
  data = lang_df,
  exact = FALSE
)
```

```{r wilcox WP lang yes no, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

lang_yesno_WP <- wilcox.test(
  `Words Produced` ~ lang_binary,
  data = lang_df,
  exact = FALSE
)

```

```{r wilcox TP lang yes no, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

lang_yesno_TP <- wilcox.test(
  `Total Produced` ~ lang_binary,
  data = lang_df,
  exact = FALSE
)

```

```{r wilcox lang result table, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

lang_wilcox_results <- data.frame(
  Outcome = c("Words Understood", "Words Produced", "Total Produced"),
  `W Statistic` = c(
    round(lang_yesno_WU$statistic, 1),
    round(lang_yesno_WP$statistic, 1),
    round(lang_yesno_TP$statistic, 1)
  ),
  `p-value` = c(
    lang_yesno_WU$p.value,
    lang_yesno_WP$p.value,
    lang_yesno_TP$p.value
  )
)

lang_wilcox_results$p_raw <- NULL

kable(lang_wilcox_results, , digits = 3) %>%
  kable_styling(full_width = FALSE, font_size = 18) %>%
  column_spec(1:ncol(lang_wilcox_results), extra_css = "font-family: 'Times New Roman';") %>%
  row_spec(0, bold = TRUE)

```

To examine whether language outcomes differed based on additional language presence within households, Wilcoxon rank-sum tests were conducted comparing children in monolingual and multilingual households across three outcome variables.

None of the comparisons reached statistical significance. These results suggest that the presence of an additional language in the household was not significantly related to vocabulary comprehension or production. However, these results should be interpreted with caution due to the relatively small sample size, which may limit statistical power and the ability to detect subtle effects.

# Reading Beliefs, Other Habits, and The In-Between

In addition to the primary parent and child reading measures, we collected exploratory items to capture broader household dynamics that may influence early language development. These items were not used in calculating the main outcome scores but were designed to provide supplementary insight into the child’s daily environment. Questions asked were answered using a Likert Scale 1 (don't agree) to 7 (fully agree). 

## Reading Sessions
### Reading Session Duration

```{r df with reading, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

reading_df <- combined %>%
  select(subject_id, age, child_score, parent_score, `Words Produced`, `Total Produced`, `How much time  (in minutes) on average do you spend reading with your child in one session?`, `Please rate each statement about reading from 1 (don't agree) to 7 (fully agree) - Reading time is for educational purposes so that my child can learn new words`, `Please rate each statement about reading from 1 (don't agree) to 7 (fully agree) - Reading time is for social purposes to bond with my child`, `Are there any other children who live in your home?`, `How stressed do you feel in the mornings? - low stress (1) to high stress (7)`, `How stressed do you feel in the evenings? - low stress (1) to high stress (7)`)

reading_df <- reading_df %>%
  rename(reading_time = `How much time  (in minutes) on average do you spend reading with your child in one session?`)

reading_df <- reading_df %>%
  rename(Edu_purp = `Please rate each statement about reading from 1 (don't agree) to 7 (fully agree) - Reading time is for educational purposes so that my child can learn new words`)

reading_df <- reading_df %>%
  rename(Social_purp = `Please rate each statement about reading from 1 (don't agree) to 7 (fully agree) - Reading time is for social purposes to bond with my child`)

reading_df <- reading_df %>%
  rename(Sib_YN = `Are there any other children who live in your home?`)

reading_df <- reading_df %>%
  rename(Evening_Stress = `How stressed do you feel in the evenings? - low stress (1) to high stress (7)`)

reading_df <- reading_df %>%
  rename(Morning_Stress = `How stressed do you feel in the mornings? - low stress (1) to high stress (7)`)

```

```{r reading time PS/CS test, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
reading_df <- reading_df %>%
  mutate(reading_time = factor(reading_time,
    levels = c("<5 minutes", "5-10 mins", "10-20 mins", ">20 mins"),
    ordered = TRUE))


reading_PS <- cor.test(as.numeric(reading_df$reading_time), reading_df$parent_score, method = "spearman", use = "complete.obs")
reading_CS <- cor.test(as.numeric(reading_df$reading_time), reading_df$child_score, method = "spearman", use = "complete.obs")

```

```{r reading time PS boxplot, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
ggplot(reading_df, aes(x = reading_time, y = parent_score)) +
  geom_boxplot(fill = "plum3", alpha = 0.7) +
  labs(x = "Time Reading per Session", y = "Parent Score") +
  theme_minimal(base_family = "Times")
```

```{r reading time CS boxplot, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
ggplot(reading_df, aes(x = reading_time, y = child_score)) +
  geom_boxplot(fill = "plum3", alpha = 0.7) +
  labs(x = "Time Reading per Session", y = "Child Score") +
  theme_minimal(base_family = "Times")
```

```{r reading CS/PS spearman result table, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

readingCSPS_wilcox_results <- data.frame(
  Outcome = c("Parent Score", "Child Score"), 
  `W Statistic` = c(
    round(reading_PS$statistic, 1),
    round(reading_CS$statistic, 1)
  ),
  `p-value` = c(
    reading_PS$p.value,
    reading_CS$p.value
  )
)

readingCSPS_wilcox_results$p_raw <- NULL

kable(readingCSPS_wilcox_results, , digits = 3) %>%
  kable_styling(full_width = FALSE, font_size = 18) %>%
  column_spec(1:ncol(readingCSPS_wilcox_results), extra_css = "font-family: 'Times New Roman';") %>%
  row_spec(0, bold = TRUE)

```

```{r ordinal regression reading CS, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.width=5, fig.height=3}


readingCS_ord <- MASS::polr(reading_time ~ child_score + parent_score,
                            data = reading_df, Hess = TRUE)

term_labels <- c(
  "child_score" = "Child Score",
  "parent_score" = "Parent Score"
)

readingCS_model <- broom::tidy(readingCS_ord, conf.int = TRUE) %>%
  as_tibble() %>%  
  mutate(
    p.value = 2 * (1 - pnorm(abs(statistic))),
    signif = case_when(
      p.value < 0.001 ~ "***",
      p.value < 0.01  ~ "**",
      p.value < 0.05  ~ "*",
      p.value < 0.1   ~ ".",
      TRUE ~ ""
    )
  )


readingCS_coef_table <- readingCS_model %>%
  filter(term %in% names(term_labels)) %>%
  mutate(Term = term_labels[term]) %>%
  select(
    Term,
    estimate,
    std.error,
    statistic,
    conf.low,
    conf.high,
    p.value,
    signif
  ) %>%
  rename(
    `Estimate (β)` = estimate,
    `Std. Error` = std.error,
    `t value` = statistic,
    `CI Low` = conf.low,
    `CI High` = conf.high,
    `p-value` = p.value,
    ` ` = signif
  ) %>%
  mutate(across(where(is.numeric), round, 4))


readingCS_coef_table %>%
  kable("html", align = "c", caption = "Ordinal Regression Coefficients") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    position = "center"
  ) %>%
  row_spec(0, bold = TRUE) %>%
  column_spec(1:ncol(readingCS_coef_table), extra_css = "font-family: 'Times New Roman', Times, serif;")
```

We used an ordinal logistic regression to examine whether parent or child scores predicted longer durations of reading sessions. The dependent variable (reading_time) was treated as an ordered factor with four categories ranging from "<5 minutes" to ">20 minutes".

The model revealed a marginal positive effect of child score on reading time:
β = 0.091, p = .052. This indicates that as child score will marginally increase the more time is spent reading.

In contrast, parent score was not a significant predictor (p = .749).
The model suggests that reading duration is more strongly associated with child characteristics than parent-reported beliefs or engagement.

### Reading Session Beliefs

```{r means of edu and soc purp by sibs, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
reading_df$Edu_purp <- as.numeric(reading_df$Edu_purp)
reading_df$Social_purp <- as.numeric(reading_df$Social_purp)

purp_summary <- reading_df %>%
  group_by(Sib_YN) %>%
  summarise(
    `Mean (Edu)` = round(mean(Edu_purp, na.rm = TRUE), 2),
    `SD (Edu)` = round(sd(Edu_purp, na.rm = TRUE), 2),
    `Mean (Social)` = round(mean(Social_purp, na.rm = TRUE), 2),
    `SD (Social)` = round(sd(Social_purp, na.rm = TRUE), 2),
    N = n()
  )

edu_test <- wilcox.test(Edu_purp ~ Sib_YN, data = reading_df)
soc_test <- wilcox.test(Social_purp ~ Sib_YN, data = reading_df)

purp_summary <- purp_summary %>%
  rename(`Sibling?` = Sib_YN)

purp_summary %>%
  kable(caption = "Reading Purpose Ratings by Sibling Presence") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                full_width = FALSE, position = "center")


cat(paste0("\n**Educational Purpose**: W = ", round(edu_test$statistic, 1),
           ", p = ", round(edu_test$p.value, 4)))

cat(paste0("\n\n**Social Purpose**: W = ", round(soc_test$statistic, 1),
           ", p = ", round(soc_test$p.value, 4)))
```

Parents in single-child households reported higher agreement with both educational and social purposes for shared reading compared to those in multi-child households. Specifically, parents without other children rated educational purpose significantly higher (M = 6.33, SD = 1.24) than parents with multiple children (M = 5.13, SD = 1.64). Although both groups rated reading as a social bonding activity highly, parents of only children again reported slightly higher agreement (M = 6.62, SD = 0.59) compared to those with siblings (M = 6.21, SD = 1.04). These findings suggest that while reading remains an important bonding experience across households, parents of only children may place greater emphasis on its educational value. This pattern aligns with the resource dilution model, which posits that the presence of siblings may reduce the time and cognitive resources available for each child, particularly for academically focused activities.

```{r paired reading purp test, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
within_test <- wilcox.test(reading_df$Edu_purp, reading_df$Social_purp, paired = TRUE)

test_summary <- tibble::tibble(
  Test = c("Edu. Purpose by Sib Status",
           "Social Purpose by Sib Status",
           "Edu. vs Social Purpose (Paired)"),
  W_or_V = c(edu_test$statistic,
             soc_test$statistic,
             within_test$statistic),
  p_value = c(edu_test$p.value,
              soc_test$p.value,
              within_test$p.value)
) %>%
  mutate(
    Test = factor(Test, levels = Test),  
    `p-value` = format.pval(p_value, digits = 3, eps = .001)
  ) %>%
  select(Test, Statistic = W_or_V, `p-value`)

knitr::kable(
  test_summary,
  caption = "Wilcoxon and Mann–Whitney Test Results",
  align = "c",
  digits = 3
) %>%
  kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    position = "center"
  ) %>%
  kableExtra::row_spec(0, bold = TRUE) %>%
  kableExtra::column_spec(1:ncol(test_summary), extra_css = "font-family: 'Times New Roman';")
```


We used non-parametric tests to explore how parents' reading purpose ratings differed by sibling presence and purpose type. Parents of only children rated reading for educational purposes significantly higher than parents with multiple children (W = 814, p = .0014). In contrast, there was no significant difference between the two groups in how they rated reading for social bonding (W = 671, p = .1278), suggesting that the social purpose of reading is valued similarly regardless of family size.

We also compared the two purposes within the same parents. A Wilcoxon signed-rank test showed that parents overall rated social bonding as a significantly stronger reason for reading than educational learning (V = 83.5, p < .001). Together, these results suggest that while parents see reading as both educational and social, those with only children may focus more on the learning aspect, possibly because they have more time or attention to give. This aligns with the Resource Dilution Model.

## Stress Levels
```{r stress levels df, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

stress_df <- combined %>%
  select(subject_id, age, child_score, parent_score, `Words Understood`, `Words Produced`, `Total Produced`, `How stressed do you feel in the mornings? - low stress (1) to high stress (7)`, `How stressed do you feel in the evenings? - low stress (1) to high stress (7)`, `Are there any other children who live in your home?`)

stress_df <- stress_df %>%
  rename(Morning_Stress = `How stressed do you feel in the mornings? - low stress (1) to high stress (7)`)

stress_df <- stress_df %>%
  rename(Evening_Stress = `How stressed do you feel in the evenings? - low stress (1) to high stress (7)`)

stress_df <- stress_df %>%
  rename(Sib_YN = `Are there any other children who live in your home?`)


stress_df <- stress_df %>%
  filter(if_all(c(Morning_Stress, Evening_Stress), ~ !is.na(.)))
```

```{r stress levels paired test, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
stress_df$Morning_Stress <- as.numeric(stress_df$Morning_Stress)
stress_df$Evening_Stress <- as.numeric(stress_df$Evening_Stress)

stress_test <- wilcox.test(stress_df$Morning_Stress, stress_df$Evening_Stress, paired = TRUE)
```
The Wilcoxon signed-rank test showed a statistically significant difference between morning and evening stress levels (V = 201, p = .00028). This suggests that, on average, participants experience different stress levels in the morning compared to the evening.

```{r stress test by sib, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
stress_df$Morning_Stress <- as.numeric(stress_df$Morning_Stress)
stress_df$Evening_Stress <- as.numeric(stress_df$Evening_Stress)

stress_sib <- stress_df %>% filter(Sib_YN == "Yes")
stress_nosib <- stress_df %>% filter(Sib_YN == "No")

stress_test_sib <- wilcox.test(stress_sib$Morning_Stress, stress_sib$Evening_Stress, paired = TRUE)
stress_test_nosib <- wilcox.test(stress_nosib$Morning_Stress, stress_nosib$Evening_Stress, paired = TRUE)


stress_by_group <- tibble(
  Group = c("With Sibling(s)", "No Sibling"),
  Statistic = c(stress_test_sib$statistic, stress_test_nosib$statistic),
  `p-value` = c(
    ifelse(stress_test_sib$p.value < 0.001, "< 0.001", round(stress_test_sib$p.value, 4)),
    ifelse(stress_test_nosib$p.value < 0.001, "< 0.001", round(stress_test_nosib$p.value, 4))
  )
)


stress_by_group %>%
  kable("html", align = "c", caption = "Morning vs Evening Stress (Within Groups)") %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed")) %>%
  row_spec(0, bold = TRUE) %>%
  column_spec(1:ncol(stress_by_group), extra_css = "font-family: 'Times New Roman';")


```

A paired Wilcoxon signed-rank test was used to compare morning and evening stress levels within households, separated by sibling presence.

Among parents in multi-child households, stress levels were significantly higher in the morning than in the evening (W = 112.5, p = 0.0014).

In contrast, for parents in single-child households, there was no significant difference between morning and evening stress (W = 14.0, p = 0.0933).

These results suggest that morning stress is more pronounced in families with multiple children, possibly due to the increased coordination and responsibilities involved in managing more than one child. For single-child households, stress levels appear to remain more stable throughout the day.

```{r stress by sib on lang, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

sib_stress_lm_model <- lm(child_score ~ Morning_Stress * Sib_YN + Evening_Stress * Sib_YN , data = stress_df)

term_labels <- c(
  "(Intercept)" = "Intercept",
  "Morning_Stress" = "Morning Stress",
  "Sib_YNYes" = "Sibling Present (Yes)",
  "Evening_Stress" = "Evening Stress",
  "Morning_Stress:Sib_YNYes" = "Interaction (Morning × Sibling)",
  "Sib_YNYes:Evening_Stress" = "Interaction (Evening × Sibling)"
)


sib_stress_lm_table <- tidy(sib_stress_lm_model, conf.int = TRUE) %>%
  filter(term %in% names(term_labels)) %>%
  mutate(Term = term_labels[term]) %>%
  select(Term, estimate, std.error, statistic, p.value) %>%
  mutate(across(where(is.numeric), ~ round(.x, 3))) %>%
  mutate(`Significance` = case_when(
    p.value < 0.001 ~ "***",
    p.value < 0.01 ~ "**",
    p.value < 0.05 ~ "*",
    p.value < 0.1 ~ ".",
    TRUE ~ ""
  )) %>%
  kable("html", caption = "Linear Model: Child Score Predicted by Morning and Evening Stress with Sibling Status",
        col.names = c("Term", "Estimate (β)", "Std. Error", "t value", "p-value", " ")) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed")) %>%
  column_spec(1:6, extra_css = "font-family: 'Times New Roman', Times, serif;") %>%
  row_spec(0, bold = TRUE)

sib_stress_lm_table

```

```{r}
plot_model(sib_stress_lm_model)
```

We examined how morning and evening parental stress and sibling presence influence children's language and behavioral outcomes, as measured by child score.

Sibling presence was a significant negative predictor (β = -13.82, p = .002), indicating that children with siblings tended to have lower scores than only children.

Evening stress was also negatively associated with child scores (β = -2.79, p = .022), suggesting that higher evening stress levels correspond to lower scores.

The interaction between evening stress and sibling presence was significant (β = 2.76, p = .037), indicating that the negative impact of evening stress on language outcomes is less pronounced when siblings are present. In other words, siblings may buffer the effect of evening stress.

Morning stress alone and its interaction with sibling presence were not statistically significant, suggesting that morning stress does not independently or interactively predict language outcomes in this model.

```{r anova for child lang outcome by stress grouped by sib, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}

stress_df <- stress_df %>%
  mutate(
    Morning_Stress = as.numeric(Morning_Stress),
    Evening_Stress = as.numeric(Evening_Stress),
    Words_Understood = as.numeric(`Words Understood`),
    Words_Produced = as.numeric(`Words Produced`),
    Total_Produced = as.numeric(`Total Produced`)
  )

anova_words_understood <- aov(Words_Understood ~ Morning_Stress + Evening_Stress + Sib_YN, data = stress_df)
anova_words_produced   <- aov(Words_Produced ~ Morning_Stress + Evening_Stress + Sib_YN, data = stress_df)
anova_total_produced   <- aov(Total_Produced ~ Morning_Stress + Evening_Stress + Sib_YN, data = stress_df)

tidy_understood <- tidy(anova_words_understood) %>% mutate(Outcome = "Words Understood")
tidy_produced   <- tidy(anova_words_produced) %>% mutate(Outcome = "Words Produced")
tidy_total      <- tidy(anova_total_produced) %>% mutate(Outcome = "Total Produced")

anova_table <- bind_rows(tidy_understood, tidy_produced, tidy_total) %>%
  filter(term != "Residuals") %>%
  mutate(across(c(statistic, p.value), ~ round(.x, 3))) %>%
  rename(
    Outcome = Outcome,
    Term = term,
    `F value` = statistic,
    `p-value` = p.value
  ) %>%
  select(Outcome, Term, `F value`, `p-value`) %>%
  arrange(Outcome, desc(`F value`))

anova_table %>%
  kable("html", caption = "ANOVA Results: Predicting Language Outcomes from Stress and Sibling Status",
        col.names = c("Outcome", "Predictor", "F value", "p-value")) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed")) %>%
  column_spec(1:4, extra_css = "font-family: 'Times New Roman';") %>%
  row_spec(0, bold = TRUE)

```

We conducted ANOVAs to assess whether Morning Stress, Evening Stress, and Sibling Presence predicted three language outcomes: Words Understood, Words Produced, and Total Words Produced.

Evening Stress emerged as a significant predictor for both Words Understood and Words Produced (F = 7.576, p = .010 for both). This suggests that higher evening stress levels may be associated with lower child language production and comprehension.

However, neither Morning Stress nor Sibling Presence significantly predicted any of the three outcomes (p > .10 in all cases). Similarly, no significant effects were observed for Total Words Produced, indicating that this broader measure of language output may be less sensitive to the household or emotional context.

These findings highlight Evening Stress as a potentially important factor in shaping early language development, particularly in terms of both understanding and producing words.

```{r box-plot of morning stress by household size, echo=FALSE, fig.align='center', fig.height=3, fig.width=5, message=FALSE, warning=FALSE}
sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)
combined$subject_id <- as.character(combined$subject_id)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)

ggplot(stress_df %>% filter(!subject_id %in% c(35, 25, 14)),
       aes(x = Sib_YN, y = Morning_Stress,colour = Sib_YN, fill=Sib_YN)) + scale_colour_manual(values = c(Yes = "darkolivegreen3", No = "tan3")) +  scale_fill_manual(values = c(Yes = "darkolivegreen3", No = "tan3")) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
    scale_y_continuous(limits = c(0,7)) +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    x = "Have Sibs?",
    y = "Morning Stress"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme + stat_summary(fun.y=mean,shape=1,col='black',geom='point', fill = "black")
```

```{r box-plot of evening stress by household size, echo=FALSE, fig.align='center', fig.height=3, fig.width=5, message=FALSE, warning=FALSE}
sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)
combined$subject_id <- as.character(combined$subject_id)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)

ggplot(stress_df %>% filter(!subject_id %in% c(35, 25, 14)),
       aes(x = Sib_YN, y = Evening_Stress,colour = Sib_YN, fill=Sib_YN)) + scale_colour_manual(values = c(Yes = "darkolivegreen3", No = "tan3")) +  scale_fill_manual(values = c(Yes = "darkolivegreen3", No = "tan3")) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
    scale_y_continuous(limits = c(0,7)) +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) * 1.25,
        label = paste0("N = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 3.5,
    family = "Times"
    ) +
  labs(
    x = "Have Sibs?",
    y = "Evening Stress"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme + stat_summary(fun.y=mean,shape=1,col='black',geom='point', fill = "black")
```

```{r box-plot of parent score by morning stress, echo=FALSE, fig.align='center', fig.height=3, fig.width=5, message=FALSE, warning=FALSE}
sibship_factors$Subject_ID <- as.character(sibship_factors$Subject_ID)
combined$subject_id <- as.character(combined$subject_id)
combined$`Words Produced` <- as.numeric(combined$`Words Produced`)
combined$`Words Understood` <- as.numeric(combined$`Words Understood`)

ggplot(stress_df %>% filter(!subject_id %in% c(35, 25, 14)),
       aes(x = parent_score, y = Evening_Stress ))  +
  geom_jitter(width = 0.2, alpha = 0.5, color = "grey40") + 
    scale_y_continuous(limits = c(0,7)) +
  labs(
    x = "Parent Score",
    y = "Evening Stress"
  ) +
  theme_minimal(base_size = 10, base_family = "Times") + custom_theme 
```
```{r evening stress time boxplot, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', fig.width=5, fig.height=3}
reading_df$Evening_Stress <- as.numeric(reading_df$Evening_Stress)

ggplot(reading_df, aes(x = reading_time, y = Evening_Stress)) +
  geom_boxplot(fill = "plum3", alpha = 0.7) +
  labs(x = "Time Reading per Session", y = " Evening Stress") +
  theme_minimal(base_family = "Times") + custom_theme
```


